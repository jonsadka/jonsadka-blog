<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/jonsadka-blog/component---src-layouts-index-js-9bcc628ad035ecfaff6c.js" as="script"/><link rel="preload" href="/jonsadka-blog/component---src-templates-blog-post-js-5316f4e0a29c550d8de0.js" as="script"/><link rel="preload" href="/jonsadka-blog/path---how-to-create-live-updating-and-flexible-d-3-line-charts-using-pseudo-data-814ac49acb19661fa0fd.js" as="script"/><link rel="preload" href="/jonsadka-blog/app-65ed1dfee9553e022a19.js" as="script"/><link rel="preload" href="/jonsadka-blog/commons-8b3777e9b7196ecd4564.js" as="script"/><title data-react-helmet="true">Your Blog Name - How to create live updating and flexible D3.js line charts using pseudo-data (interactive tutorial and example)</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="1464896840"><!-- react-empty: 2 --><div style="background:rebeccapurple;margin-bottom:1.45rem;" data-reactid="3"><div style="margin:0 auto;max-width:960px;padding:1.45rem 1.0875rem;" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a style="color:white;text-decoration:none;" href="/jonsadka-blog/" data-reactid="6">Jon Sadka&#x27;s Blog</a></h1></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="7"><div class="blog-post-container" data-reactid="8"><!-- react-empty: 9 --><div class="blog-post" data-reactid="10"><h1 data-reactid="11">How to create live updating and flexible D3.js line charts using pseudo-data (interactive tutorial and example)</h1><div class="blog-post-content" data-reactid="12"><p>One of the bigger challenges in visualizing data is making your charts responsive so that they can resize no matter what range of data is thrown at it. Things get even more complicated when the dataset is actually a collection of many individual sets of data. One obvious example of this is a dataset containing (x,y) coordinates for multiple lines. The goal is to create a chart similar to the one below, which adapts to any new data thrown at it.</p>
<iframe width="960" height="500" src="https://cdn.rawgit.com/jonsadka/482005612916b3f5e408/raw/7c05bc7b136a269d39e87138d745c368f69560f0/index.html" marginwidth="0" marginheight="0" scrolling="no" align="middle"></iframe>
<h3>Generate data</h3>
<p>The best way to test the functionality of your graph is to generate new pseudo-data at a set interval and update the graph at the same interval. I had previously blogged about how to generate large datasets using D3.js and JavaScript; if you are not familiar with this process, I strongly recommend that you take a quick read through that (<a href="http://jonsadka.com/blog/how-to-quickly-create-randomly-generated-datasets-in-javascript-with-d3/">link</a>). For this example, we need to start by creating a function that returns a dataset comprised of (x,y) coordinates for any specified number of lines. The function below takes two arguments, the desired number of lines and the desired number of points, and returns a 2D array where each nested array is a series of (x,y) coordinates pertaining to that line. The y coordinate is multiplied by 100 to better exaggerate this example.</p>
<pre><code class="language-javascript">function newData(lineNumber, points){
  return d3.range(lineNumber).map(function(){
    return d3.range(points).map(function(item,index){
      return { x:index, y:Math.random()*100 };
    });
  });
}
</code></pre>
<h3>Setup page elements</h3>
<p>Now, we can start to setup up our page elements, such as the svg dimensions, along with the margins.</p>
<pre><code class="language-javascript">var width = 960;
var height = 500;

var margin = {top: 20, right:20, bottom:20, left:50};

var svg = d3.select("body").append("svg")
  .attr("height", height).attr("width", width)
  .append("g")
    .attr("transform","translate(" + margin.left + "," + margin.right + ")")
</code></pre>
<p>Thinking about the scales for our x and y coordinates, we can assume that our window frame is constant. It’s good practice to make these ranges dynamic based on the page dimensions, but I will gloss over it purpose of this example. The thing to keep in mind is that although our ranges are constant, our domains will change with each generation of new data, so we will leave out our range specifications for now.</p>
<pre><code class="language-javascript">var xScale = d3.scale.linear()
  .range([0,width - margin.left - margin.right])

var yScale = d3.scale.linear()
  .range([height - margin.top - margin.bottom,0])

var line = d3.svg.line().interpolate("monotone")
  .x(function(d){ return xScale(d.x); })
  .y(function(d){ return yScale(d.y); })
</code></pre>
<h3>Create <code>render</code> function</h3>
<p>Now what we must do is encapsulate the rest of the program in a function, which I have called <code>render()</code>, that will update our graph when a new dataset is created. When <code>render</code> is invoked, it first must generate a new collection of data and gather the absolute minimum and maximum in the dataset. This means that we need to loop through each set of data (i.e. line), compare the minimums and maximums amongst the other sets of data (i.e. other lines) and pull the most extreme ones of the collection. Once we have done that, we can specify the domain for our scales.</p>
<pre><code class="language-javascript">function render(){
  // generate new dataset
  var data = newData(8,3);

  // obtain absolute min and max
  var yMin = data.reduce(function(pv,cv){
    var currentMin = cv.reduce(function(pv,cv){
      return Math.min(pv,cv.y);
    },100)
    return Math.min(pv,currentMin);
  },100);
  var yMax = data.reduce(function(pv,cv){
    var currentMax = cv.reduce(function(pv,cv){
      return Math.max(pv,cv.y);
    },0)
    return Math.max(pv,currentMax);
  },0);

  // set as domain for axis
  yScale.domain([yMin,yMax]);
}
</code></pre>
<p>In this example, we are not drawing an x-axis and therefore are not specifying a domain for the xScale, however the process would be extremely similar if that was desired. Now that we have our scale set for this specific set of data, we can create our y-axis within our render function.</p>
<pre><code class="language-javascript">// create axis
var yAxis = d3.svg.axis().scale(yScale).orient("left");

// remove any previously drawn axis
svg.selectAll(".y.axis").remove();

// draw the new axis
svg.append("g").attr("class","y axis").call(yAxis);
</code></pre>
<p>Last, we need to follow a similar process for drawing our lines:</p>
<pre><code class="language-javascript">// remove any previously drawn lines
svg.selectAll(".line").remove();

// draw new lines
var lines = svg.selectAll(".line").data(data).attr("class","line");

// enter and append these lines
lines.enter().append("path")
    .attr("class","line")
    .attr("d",line).style("stroke","blue");
</code></pre>
<p>And now, we have created our <code>render</code> function. All we need to do is call <code>render</code> and apply a <code>setInterval</code> on this function:</p>
<pre><code class="language-javascript">function render(){
  var data = newData(8,3);

  var yMin = data.reduce(function(pv,cv){
    var currentMin = cv.reduce(function(pv,cv){
      return Math.min(pv,cv.y);
    },100)
    return Math.min(pv,currentMin);
  },100);
  var yMax = data.reduce(function(pv,cv){
    var currentMax = cv.reduce(function(pv,cv){
      return Math.max(pv,cv.y);
    },0)
    return Math.max(pv,currentMax);
  },0);

  yScale.domain([yMin,yMax]);

  var yAxis = d3.svg.axis().scale(yScale).orient("left");

  svg.selectAll(".y.axis").remove();

  svg.append("g").attr("class","y axis").call(yAxis);

  svg.selectAll(".line").remove();

  var lines = svg.selectAll(".line").data(data).attr("class","line");

  lines.enter().append("path")
    .attr("class","line")
    .attr("d",line).style("stroke","blue");
}

render();
setInterval(render, 1500);
</code></pre>
<iframe width="480" height="250" src="https://cdn.rawgit.com/jonsadka/6928acb9f561e5a4cbc2/raw/ecb990fcb7796b5d8698dd5d9b2d4f8e6ff7c965/index.html" marginwidth="0" marginheight="0" scrolling="no" align="middle"></iframe>
<h3>Add transitions</h3>
<p>But how do we make this graph beautifully animate and transition? First, let’s take a look at our axis. What we need to do is add a conditional statement to check to see if our scale exists. If so, all we need to do is add a transition to the new yAxis.</p>
<pre><code class="language-javascript">// if no axis exists, create one
if (svg.selectAll(".y.axis")[0].length &#x3C; 1 ){
  svg.append("g")
    .attr("class","y axis")
   .call(yAxis)
// otherwise, update the axis
} else {
  svg.selectAll(".y.axis").transition().duration(1500).call(yAxis)
}
</code></pre>
<p>Now how do we update our lines? What we need to do is select all the lines currently on the page, transition them to the new line with any new attributes or styles, enter the changes in the data, and exit.</p>
<pre><code class="language-javascript">// draw the lines
var lines = svg.selectAll(".line").data(data).attr("class","line")

// transition from previous paths to new paths
lines.transition().duration(1500)
  .attr("d",line)
  .style("stroke", function(){
    return '#'+Math.floor(Math.random()*16777215).toString(16);
  });

// enter any new lines
lines.enter()
  .append("path")
  .attr("class","line")
  .attr("d",line)
  .style("stroke", function(){
    return '#'+Math.floor(Math.random()*16777215).toString(16);
  });

// exit
lines.exit().remove();
</code></pre>
<iframe width="480" height="250" src="https://cdn.rawgit.com/jonsadka/a1b1d1d955220941446f/raw/c14d338163033954c461e9a051cff3ad326b0a33/index.html" marginwidth="0" marginheight="0" scrolling="no"></iframe>
<h3>Complete code</h3>
<p>That’s it! If you’re interested in seeing the complete code, go ahead and check out my bl.ocks: <a href="http://bl.ocks.org/jonsadka/482005612916b3f5e408">http://bl.ocks.org/jonsadka/482005612916b3f5e408</a></p></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-65ed1dfee9553e022a19.js","107818501498521":"component---src-templates-blog-post-js-5316f4e0a29c550d8de0.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-1f464814ec1087b64fd4.js","218538773642512":"component---src-pages-page-2-js-8303b1dab01b6fff490b.js","60335399758886":"path----557518bd178906f8d58a.js","10171900593404":"path---choosing-the-best-numbers-in-nfl-football-squares-to-beat-your-friends-71dd690a8f6a19e224a6.js","50182333802029":"path---how-to-generate-time-series-week-over-week-year-over-year-aggregations-in-mongodb-using-unix-epoch-timestamps-tutorial-and-example-f6df15732aaed9da6980.js","226515019055661":"path---how-to-write-data-to-the-beginning-of-a-file-with-node-javascript-tutorial-and-example-7fee02881be96763d681.js","71122540562017":"path---how-apple-can-catch-up-to-google-ratings-and-yelp-reviews-overnight-f53ccca06962a3318385.js","61368061307467":"path---best-and-worst-times-to-take-an-uber-ca1a2a2f4255e8a87358.js","219282622727209":"path---how-to-create-adaptive-pie-charts-with-transitions-in-d-3-7bcb6afac163e5c215e6.js","27746275504635":"path---how-to-create-live-updating-and-flexible-d-3-line-charts-using-pseudo-data-814ac49acb19661fa0fd.js","176459137894972":"path---how-to-modify-filter-and-save-json-files-locally-using-jquery-316e2eeedcd35bff693f.js","28430980993147":"path---how-to-quickly-create-randomly-generated-datasets-in-javascript-with-d-3-de27b665e45a7cad19a6.js","140111421340535":"path---using-reduce-to-create-arrays-and-objects-in-javascript-cd817ad43fca6c04a3c2.js","238983728261001":"path---how-to-use-the-uber-api-to-get-pricing-data-82f59817e4c43edc61a8.js","64521555383069":"path---fight-on-the-power-of-javascript-closures-c1c5d3d67a13bdffe2ae.js","274554345536044":"path---prototypal-and-pseudoclassical-instantiation-in-javascript-0d7403c3aad990f9d66b.js","2567721212742":"path---type-coercion-in-d-3-js-63fe3fde1e13146131fa.js","224731842900174":"path---supercharge-your-falsey-conditional-statements-in-javascript-95456ddd1a7b9da44704.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-86ff36649d59fd526cd1.js","135728916539164":"path---page-2-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-9bcc628ad035ecfaff6c.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/jonsadka-blog/commons-8b3777e9b7196ecd4564.js","/jonsadka-blog/app-65ed1dfee9553e022a19.js","/jonsadka-blog/path---how-to-create-live-updating-and-flexible-d-3-line-charts-using-pseudo-data-814ac49acb19661fa0fd.js","/jonsadka-blog/component---src-templates-blog-post-js-5316f4e0a29c550d8de0.js","/jonsadka-blog/component---src-layouts-index-js-9bcc628ad035ecfaff6c.js"])/*]]>*/</script></body></html>