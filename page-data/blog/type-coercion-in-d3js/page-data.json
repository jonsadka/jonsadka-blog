{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/type-coercion-in-d3js","result":{"data":{"markdownRemark":{"id":"2c00c84e-3c60-500f-8eeb-736b5c81b11c","html":"<p>D3.js is an amazing platform that allows software engineers to bind data to each DOM element that exists, or will be, created.  This data can then be used to compile graphs, charts, or any other visual means. Last week, I had the opportunity to play around with D3.js and created a simple little game <a href=\"http://jonsadka.github.io/watchout\">(click to play watchout!)</a>.  During that time, I discovered that D3.js does this funny thing with type coercion; when you try to add two numbers obtained from element attributes, it returns a string.</p>\n<p>Let’s look at the following example.  Suppose we wanted to create a game and add two objects, an enemy object and a player object.  And suppose we wanted the game to end when the enemy collides with the player.  One way to do this is to calculate the distance between the two objects; if the distance between the two is less than 1/2 their width (or the radius in the instance of a circle), then the two objects have collided.</p>\n<h3>Collision example</h3>\n<p>Below, let’s create the player and the red-colored enemy:</p>\n<pre><code class=\"language-javascript\">d3.select('body').selectAll('player')\n  .data([[]]).enter().append('circle')\n  .attr(\"class\", \"player\")\n  .attr('cx', 200 ).attr('cy', 200 )\n  .attr('r', 10)\n</code></pre>\n<pre><code class=\"language-javascript\">d3.select('body').selectAll('enemy')\n  .data( [[]] ).enter().append('circle')\n  .attr(\"class\", \"enemy\")\n  .attr('cx', 100).attr('cy', 100)\n  .attr('r', 15 )\n  .attr('fill','red')\n</code></pre>\n<p>Now that the players are created, we know that the distance between the two can be achieved using the <a href=\"http://en.wikipedia.org/wiki/Pythagorean_theorem\">Pythagorean Theorem</a> ( length = sqrt(  Δx^2 +  Δy^2  ) ).  Now this length, must be less than the addition of their two radii’s for there to be a collision.  We can get the radii of the enemy and the player as follows:</p>\n<pre><code class=\"language-javascript\">const playerSize = d3.select('.player').attr('r');\nconst enemySize = d3.select('.enemy').attr('r');\nconst collideDistance = playerSize + enemySize;\n</code></pre>\n<p>But wait! What happened to our collide distance variable and why is it 1015?  Turns out, D3.js treats <code>playerSize</code> and <code>enemySize</code> as strings and adds them instead of adding two numbers. We can correct this and get <code>collideDistance</code> to be 25 (i.e. 10 + 15) by forcing type coercion by adding a plus sign in front of each variable to declare them as numbers.</p>\n<pre><code class=\"language-javascript\">const collideDistance = +playerSize + +enemySize;\n</code></pre>\n<p>As an aside, the above is similar to below, but is more concise.</p>\n<pre><code class=\"language-javascript\">const collideDistance = Number(playerSize) + Number(enemySize);\n</code></pre>\n<p>D3.js is a powerful resource in manipulating data and provides developers with a tremendous amount of flexibility.  There are a lot of helpful resources on the web and the creator, Mike Bostock, has done a fantastic job of compiling and documenting a lot of examples.  Creating the game was fairly straightforward and it’s quite easy to pickup. I encourage all of you to try out D3.js.</p>","frontmatter":{"date":"1407135600000","path":"/blog/type-coercion-in-d3js","title":"Type coercion in D3.js"}}},"pageContext":{}}}